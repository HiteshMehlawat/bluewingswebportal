<div class="min-h-screen bg-gray-50 p-6">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="mb-8">
            <h1 class="text-3xl font-bold text-gray-900 mb-2">
                {{ isClient ? 'My Documents' : (authService.isStaff() ? 'My Assigned Documents' : 'Document Management')
                }}
            </h1>
            <p class="text-gray-600">
                {{ isClient ? 'View and manage your uploaded documents' :
                (authService.isStaff() ? 'View and manage documents from your assigned tasks' : 'Upload, view, and
                manage client documents securely') }}
            </p>
        </div>

        <!-- Statistics Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-blue-100 text-blue-600">
                        <span class="material-icons text-2xl">folder</span>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-600">Total Documents</p>
                        <p class="text-2xl font-bold text-gray-900">{{ statistics?.totalDocuments || 0 }}</p>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-green-100 text-green-600">
                        <span class="material-icons text-2xl">verified</span>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-600">Verified</p>
                        <p class="text-2xl font-bold text-gray-900">{{ statistics?.verifiedDocuments || 0 }}</p>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-yellow-100 text-yellow-600">
                        <span class="material-icons text-2xl">pending</span>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-600">Pending</p>
                        <p class="text-2xl font-bold text-gray-900">{{ statistics?.pendingDocuments || 0 }}</p>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-red-100 text-red-600">
                        <span class="material-icons text-2xl">cancel</span>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-600">Rejected</p>
                        <p class="text-2xl font-bold text-gray-900">{{ statistics?.rejectedDocuments || 0 }}</p>
                    </div>
                </div>
            </div>

            <!-- <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-purple-100 text-purple-600">
                        <span class="material-icons text-2xl">cloud_upload</span>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-600">Uploaded Today</p>
                        <p class="text-2xl font-bold text-gray-900">{{ statistics?.documentsUploadedToday || 0 }}</p>
                    </div>
                </div>
            </div> -->
        </div>

        <!-- Action Buttons -->
        <div class="bg-white rounded-lg shadow mb-6 p-6">
            <div class="flex flex-wrap items-center justify-between gap-4">
                <div class="flex items-center gap-4">
                    <button (click)="openUploadModal()"
                        class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors">
                        <span class="material-icons text-base">cloud_upload</span>
                        {{ isClient ? 'Upload My Document' : (authService.isStaff() ? 'Upload Document for Client' :
                        'Upload Document') }}
                    </button>
                    <button
                        (click)="isClient ? loadClientDocuments() : (authService.isStaff() ? loadStaffDocuments() : loadDocuments())"
                        class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors">
                        <span class="material-icons text-base">refresh</span>
                        Refresh
                    </button>
                </div>
            </div>
        </div>

        <!-- Search and Filters -->
        <div class="bg-white rounded-lg shadow mb-6 p-6">
            <!-- Admin Filters -->
            <div *ngIf="!isClient && !authService.isStaff()"
                class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-7 gap-4">
                <!-- Search -->
                <div class="lg:col-span-2">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Search Documents</label>
                    <div class="relative">
                        <input type="text" [(ngModel)]="searchTerm" (keyup.enter)="searchDocuments()"
                            placeholder="Search by filename or document type..."
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <button (click)="searchDocuments()"
                            class="absolute right-2 top-2 text-gray-400 hover:text-gray-600">
                            <span class="material-icons text-base">search</span>
                        </button>
                    </div>
                </div>

                <!-- Client Filter -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Client</label>
                    <select [(ngModel)]="selectedClientId" (change)="onClientFilterChange()"
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option [ngValue]="null">All Clients</option>
                        <option *ngFor="let client of clients" [ngValue]="client.id">{{ client.companyName }}</option>
                    </select>
                </div>

                <!-- Task Filter -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Task</label>
                    <select [(ngModel)]="selectedTaskId"
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                        [disabled]="!!selectedClientId && filteredTasks.length === 0">
                        <option [ngValue]="null">All Tasks</option>
                        <option *ngFor="let task of filteredTasks" [ngValue]="task.id">{{ task.title }}</option>
                    </select>
                    <p *ngIf="selectedClientId && filteredTasks.length === 0" class="text-xs text-gray-500 mt-1">
                        No tasks found for selected client
                    </p>
                </div>

                <!-- Document Type Filter -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Document Type</label>
                    <select [(ngModel)]="selectedDocumentType"
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option value="">All Types</option>
                        <option *ngFor="let type of documentTypes" [value]="type.value">{{ type.label }}</option>
                    </select>
                </div>

                <!-- Verification Status Filter -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                    <select [(ngModel)]="selectedVerificationStatus"
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option *ngFor="let status of verificationStatuses" [value]="status.value">{{ status.label }}
                        </option>
                    </select>
                </div>

                <!-- Filter Actions -->
                <div class="flex items-end gap-2">
                    <button (click)="applyFilters()"
                        class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors">
                        Apply
                    </button>
                    <button (click)="clearFilters()"
                        class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors">
                        Clear
                    </button>
                </div>
            </div>

            <!-- Staff Filters -->
            <div *ngIf="authService.isStaff()" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4">
                <!-- Search -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Search My Documents</label>
                    <div class="relative">
                        <input type="text" [(ngModel)]="searchTerm" (keyup.enter)="searchStaffDocuments()"
                            placeholder="Search by filename, client, or task..."
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <button (click)="searchStaffDocuments()"
                            class="absolute right-2 top-2 text-gray-400 hover:text-gray-600">
                            <span class="material-icons text-base">search</span>
                        </button>
                    </div>
                </div>

                <!-- Client Filter (Staff assigned clients only) -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Client</label>
                    <select [(ngModel)]="selectedClientId" (change)="onClientFilterChange()"
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option [ngValue]="null">All My Clients</option>
                        <option *ngFor="let client of clients" [ngValue]="client.id">{{ client.companyName }}</option>
                    </select>
                </div>

                <!-- Task Filter (Staff assigned tasks only) -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Task</label>
                    <select [(ngModel)]="selectedTaskId"
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                        [disabled]="!!selectedClientId && filteredTasks.length === 0">
                        <option [ngValue]="null">All My Tasks</option>
                        <option *ngFor="let task of filteredTasks" [ngValue]="task.id">{{ task.title }}</option>
                    </select>
                    <p *ngIf="selectedClientId && filteredTasks.length === 0" class="text-xs text-gray-500 mt-1">
                        No tasks found for selected client
                    </p>
                </div>

                <!-- Document Type Filter -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Document Type</label>
                    <select [(ngModel)]="selectedDocumentType"
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option value="">All Types</option>
                        <option *ngFor="let type of documentTypes" [value]="type.value">{{ type.label }}</option>
                    </select>
                </div>

                <!-- Verification Status Filter -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                    <select [(ngModel)]="selectedVerificationStatus"
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option *ngFor="let status of verificationStatuses" [value]="status.value">{{ status.label }}
                        </option>
                    </select>
                </div>

                <!-- Filter Actions -->
                <div class="flex items-end gap-2">
                    <button (click)="applyStaffFilters()"
                        class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors">
                        Apply
                    </button>
                    <button (click)="clearStaffFilters()"
                        class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors">
                        Clear
                    </button>
                </div>
            </div>

            <!-- Client Filters -->
            <div *ngIf="isClient" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <!-- Search -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Search My Documents</label>
                    <div class="relative">
                        <input type="text" [(ngModel)]="searchTerm" (keyup.enter)="searchClientDocuments()"
                            placeholder="Search by filename..."
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <button (click)="searchClientDocuments()"
                            class="absolute right-2 top-2 text-gray-400 hover:text-gray-600">
                            <span class="material-icons text-base">search</span>
                        </button>
                    </div>
                </div>

                <!-- Document Type Filter -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Document Type</label>
                    <select [(ngModel)]="selectedDocumentType"
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option value="">All Types</option>
                        <option *ngFor="let type of documentTypes" [value]="type.value">{{ type.label }}</option>
                    </select>
                </div>

                <!-- Verification Status Filter -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                    <select [(ngModel)]="selectedVerificationStatus"
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option *ngFor="let status of verificationStatuses" [value]="status.value">{{ status.label }}
                        </option>
                    </select>
                </div>

                <!-- Filter Actions -->
                <div class="flex items-end gap-2">
                    <button (click)="applyClientFilters()"
                        class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors">
                        Apply
                    </button>
                    <button (click)="clearClientFilters()"
                        class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors">
                        Clear
                    </button>
                </div>
            </div>
        </div>

        <!-- Error Message -->
        <div *ngIf="error"
            class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6 flex items-center justify-between">
            <span>{{ error }}</span>
            <button (click)="clearError()" class="text-red-700 hover:text-red-900">
                <span class="material-icons text-base">close</span>
            </button>
        </div>

        <!-- Loading Spinner -->
        <div *ngIf="loading" class="flex justify-center items-center py-8">
            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
        </div>

        <!-- Documents Table -->
        <div *ngIf="!loading" class="bg-white rounded-lg shadow overflow-hidden">
            <div class="overflow-x-auto max-h-[500px] overflow-y-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50 sticky top-0">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Document</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Client</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Type</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Status</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Uploaded By</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Upload Date</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Actions</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        <tr *ngFor="let document of documents" class="hover:bg-gray-50">
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0 h-10 w-10">
                                        <div
                                            class="h-10 w-10 rounded-full bg-gray-100 flex items-center justify-center">
                                            <span class="material-icons text-gray-600">{{ getFileIcon(document.fileType)
                                                }}</span>
                                        </div>
                                    </div>
                                    <div class="ml-4">
                                        <div class="text-sm font-medium text-gray-900">{{ document.originalFileName }}
                                        </div>
                                        <div class="text-sm text-gray-500">{{ formatFileSize(document.fileSize) }}</div>
                                    </div>
                                </div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900">{{ document.clientName }}</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900">{{ getDocumentTypeDisplayName(document.documentType)
                                    }}</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span
                                    class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full {{ getVerificationStatusColor(document.status) }}">
                                    {{ getVerificationStatusText(document.status) }}
                                </span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900">{{ document.uploadedByName }}</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900">{{ document.uploadDate | dateFormat:'medium' }}</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                <div class="flex items-center gap-2">
                                    <button (click)="viewDocument(document)" class="text-blue-600 hover:text-blue-900"
                                        title="View Details">
                                        <span class="material-icons text-base">visibility</span>
                                    </button>
                                    <button (click)="downloadDocument(document)"
                                        class="text-green-600 hover:text-green-900" title="Download">
                                        <span class="material-icons text-base">download</span>
                                    </button>

                                    <!-- Admin/Staff Actions -->
                                    <div *ngIf="!isClient" class="flex items-center gap-2">
                                        <button
                                            (click)="authService.isStaff() ? verifyStaffDocument(document) : verifyDocument(document)"
                                            class="text-purple-600 hover:text-purple-900"
                                            [title]="document.status === 'VERIFIED' ? 'Unverify' : 'Verify'">
                                            <span class="material-icons text-base">verified</span>
                                        </button>
                                        <button
                                            (click)="authService.isStaff() ? rejectStaffDocument(document) : rejectDocument(document)"
                                            class="text-orange-600 hover:text-orange-900"
                                            [title]="document.status === 'REJECTED' ? 'Unreject' : 'Reject'">
                                            <span class="material-icons text-base">cancel</span>
                                        </button>
                                        <button (click)="openDeleteDialog(document)"
                                            class="text-red-600 hover:text-red-900" title="Delete">
                                            <span class="material-icons text-base">delete</span>
                                        </button>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Pagination -->
        <div class="mt-6">
            <app-pagination [total]="totalItems" [page]="currentPage + 1" [pageSize]="pageSize"
                (pageChange)="isClient ? onClientPageChange($event) : (authService.isStaff() ? onStaffPageChange($event) : onPageChange($event))"
                (pageSizeChange)="isClient ? onClientPageSizeChange($event) : (authService.isStaff() ? onStaffPageSizeChange($event) : onPageSizeChange($event))">
            </app-pagination>
        </div>
    </div>

    <!-- Upload Modal -->
    <div *ngIf="showUploadModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-xl shadow-xl max-w-md w-full">
            <!-- Header -->
            <div class="flex items-center justify-between p-6 border-b">
                <h2 class="text-xl font-semibold text-gray-800">
                    {{ isClient ? 'Upload My Document' : (authService.isStaff() ? 'Upload Document for Client' : 'Upload
                    Document') }}
                </h2>
                <button (click)="closeUploadModal()" class="text-gray-400 hover:text-gray-600">
                    <span class="material-icons text-2xl">close</span>
                </button>
            </div>

            <!-- Content -->
            <div class="p-6">
                <form [formGroup]="uploadForm" (ngSubmit)="uploadDocument()">
                    <!-- Client Selection (Admin/Staff only) -->
                    <div *ngIf="!isClient" class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Client *</label>
                        <select formControlName="clientId" (change)="onClientSelectionChange()"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option [ngValue]="null">Select Client</option>
                            <option *ngFor="let client of clients" [ngValue]="client.id">{{ client.companyName }}
                            </option>
                        </select>
                    </div>

                    <!-- Task Selection (Required) -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Task *</label>
                        <select formControlName="taskId"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            [disabled]="!isClient && !uploadForm.get('clientId')?.value">
                            <option [ngValue]="null">Select Task</option>
                            <option *ngFor="let task of filteredTasks" [ngValue]="task.id">{{ task.title }}</option>
                        </select>
                        <p *ngIf="!isClient && !uploadForm.get('clientId')?.value" class="text-xs text-gray-500 mt-1">
                            Please select a client first to see available tasks
                        </p>
                    </div>

                    <!-- Document Type -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Document Type *</label>
                        <select formControlName="documentType"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">Select Document Type</option>
                            <option *ngFor="let type of documentTypes" [value]="type.value">{{ type.label }}</option>
                        </select>
                    </div>

                    <!-- File Upload -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2">File *</label>
                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                            <input type="file" (change)="onFileSelected($event)"
                                accept=".pdf,.jpg,.jpeg,.png,.doc,.docx" class="hidden" id="fileInput">
                            <label for="fileInput" class="cursor-pointer">
                                <span class="material-icons text-4xl text-gray-400 mb-2">cloud_upload</span>
                                <p class="text-sm text-gray-600">Click to select file or drag and drop</p>
                                <p class="text-xs text-gray-500 mt-1">PDF, JPG, PNG, DOC, DOCX (Max 10MB)</p>
                            </label>
                        </div>
                        <div *ngIf="selectedFile" class="mt-2 text-sm text-gray-600">
                            Selected: {{ selectedFile.name }}
                        </div>
                    </div>

                    <!-- Upload Progress -->
                    <div *ngIf="isUploading" class="mb-4">
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-blue-600 h-2 rounded-full" [style.width.%]="uploadProgress"></div>
                        </div>
                        <p class="text-sm text-gray-600 mt-1">Uploading... {{ uploadProgress }}%</p>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex justify-end gap-4">
                        <button type="button" (click)="closeUploadModal()"
                            class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                            Cancel
                        </button>
                        <button type="submit" [disabled]="!isFormValid() || isUploading"
                            class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed">
                            {{ isUploading ? 'Uploading...' : 'Upload Document' }}
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- View Document Modal -->
    <div *ngIf="showViewModal && selectedDocument"
        class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <!-- Header -->
            <div class="flex items-center justify-between p-6 border-b">
                <h2 class="text-xl font-semibold text-gray-800">Document Details</h2>
                <button (click)="closeViewModal()" class="text-gray-400 hover:text-gray-600">
                    <span class="material-icons text-2xl">close</span>
                </button>
            </div>

            <!-- Content -->
            <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Document Information -->
                    <div class="space-y-4">
                        <h3 class="text-lg font-medium text-blue-700 border-b pb-2">Document Information</h3>
                        <div class="space-y-3">
                            <div><span class="font-semibold">File Name:</span> {{ selectedDocument.originalFileName }}
                            </div>
                            <div><span class="font-semibold">File Size:</span> {{
                                formatFileSize(selectedDocument.fileSize) }}</div>
                            <div><span class="font-semibold">File Type:</span> {{ selectedDocument.fileType }}</div>
                            <div><span class="font-semibold">Document Type:</span> {{
                                getDocumentTypeDisplayName(selectedDocument.documentType) }}</div>
                            <div><span class="font-semibold">Status:</span>
                                <span
                                    class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full {{ getVerificationStatusColor(selectedDocument.status) }}">
                                    {{ getVerificationStatusText(selectedDocument.status) }}
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- Client Information -->
                    <div class="space-y-4">
                        <h3 class="text-lg font-medium text-green-700 border-b pb-2">Client Information</h3>
                        <div class="space-y-3">
                            <div><span class="font-semibold">Client:</span> {{ selectedDocument.clientName }}</div>
                            <div><span class="font-semibold">Uploaded By:</span> {{ selectedDocument.uploadedByName }}
                            </div>
                            <div><span class="font-semibold">Upload Date:</span> {{ selectedDocument.uploadDate |
                                date:'medium' }}</div>
                            <div *ngIf="selectedDocument.verifiedByName"><span class="font-semibold">Verified By:</span>
                                {{ selectedDocument.verifiedByName }}</div>
                            <div *ngIf="selectedDocument.verifiedAt"><span class="font-semibold">Verified At:</span> {{
                                selectedDocument.verifiedAt | date:'medium' }}</div>
                        </div>
                    </div>

                    <!-- Rejection Information (only show if document is rejected) -->
                    <div *ngIf="selectedDocument.status === 'REJECTED' && selectedDocument.rejectedByName"
                        class="space-y-4">
                        <h3 class="text-lg font-medium text-red-700 border-b pb-2">Rejection Information</h3>
                        <div class="space-y-3">
                            <div><span class="font-semibold">Rejected By:</span> {{ selectedDocument.rejectedByName }}
                            </div>
                            <div *ngIf="selectedDocument.rejectedAt"><span class="font-semibold">Rejected At:</span> {{
                                selectedDocument.rejectedAt | date:'medium' }}</div>
                            <div *ngIf="selectedDocument.rejectionReason">
                                <span class="font-semibold">Rejection Reason:</span>
                                <div class="mt-1 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-800">
                                    {{ selectedDocument.rejectionReason }}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex justify-end gap-4 mt-8 pt-6 border-t">
                    <button (click)="closeViewModal()"
                        class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                        Close
                    </button>
                    <button (click)="downloadDocument(selectedDocument)"
                        class="px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">
                        Download
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Reject Document Modal -->
    <div *ngIf="showRejectModal && documentToReject"
        class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-xl shadow-xl max-w-md w-full">
            <!-- Header -->
            <div class="flex items-center justify-between p-6 border-b">
                <h2 class="text-xl font-semibold text-gray-800">Reject Document</h2>
                <button (click)="cancelReject()" class="text-gray-400 hover:text-gray-600">
                    <span class="material-icons text-2xl">close</span>
                </button>
            </div>

            <!-- Content -->
            <div class="p-6">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Document</label>
                    <div class="text-gray-900 font-medium">{{ documentToReject.originalFileName }}</div>
                    <div class="text-sm text-gray-500">{{ documentToReject.clientName }}</div>
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Rejection Reason *</label>
                    <textarea [(ngModel)]="rejectionReason" rows="4"
                        placeholder="Please provide a reason for rejecting this document..."
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 resize-none"></textarea>
                    <p class="text-xs text-gray-500 mt-1">This reason will be recorded with the rejection</p>
                </div>

                <!-- Action Buttons -->
                <div class="flex justify-end gap-4">
                    <button (click)="cancelReject()"
                        class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                        Cancel
                    </button>
                    <button (click)="confirmReject()" [disabled]="!rejectionReason.trim()"
                        class="px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed">
                        Reject Document
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Confirm Delete Dialog -->
    <app-confirm-dialog *ngIf="showDeleteDialog && documentToDelete" [title]="'Delete Document'"
        [message]="'Are you sure you want to delete this document? This action cannot be undone.'"
        (confirm)="deleteDocument()" (cancel)="cancelDelete()">
    </app-confirm-dialog>
</div>